<div class="card" id="formCard">
  <h2>ğŸ“ Subscription Request</h2>
  <p>Fill the form to subscribe. You'll receive payment instructions via email.</p>

  <form id="customerForm">
    <label>ğŸ‘¤ Full Name</label>
    <input type="text" name="name" required>

    <label>ğŸ“ Contact Number</label>
    <input type="tel" name="contact" required>

    <label>ğŸ“§ Email Address</label>
    <input type="email" name="email" required>

    <label>ğŸ› ï¸ Request Type</label>
    <select name="requestType" required>
      <option value="new">New Subscription</option>
      <option value="renew">Renew Existing</option>
    </select>

    <label>ğŸ§© Service</label>
    <select name="service" id="service" required>
      <option value="ChatGPT">ChatGPT Pro</option>
      <option value="Microsoft 365">Microsoft 365</option>
      <option value="Canva Pro">Canva Pro</option>
      <option value="Duolingo">Duolingo</option>
      <option value="Assignment Check">Assignment Check</option>
      <option value="Perplexity">Perplexity Pro</option>
      <option value="Amazon Prime Video">Amazon Prime Video</option>
      <option value="Adobe Creative Cloud">Adobe Creative Cloud</option>
    </select>

    <label>â³ Duration</label>
    <select name="duration" id="duration" required>
      <option>1 Month</option>
      <option>6 Months</option>
      <option>1 Year</option>
    </select>

    <label>ğŸ—’ï¸ Notes / Ref</label>
    <textarea name="notes" rows="3" placeholder="Optional..."></textarea>

    <input type="hidden" id="price" name="amount" required>

    <div class="price-summary sticky" id="priceDisplay">
      ğŸ›’ Total Price
      <span>MVR 0 ($0.00)</span>
    </div>

    <button type="submit">Submit</button>
  </form>
</div>

<script>
  document.getElementById('startButton').onclick = () => {
    document.getElementById('landingPage').style.display = 'none';
    document.getElementById('formCard').style.display = 'block';
  };

  const priceMap = {
    "ChatGPT": { "1 Month": 100, "6 Months": 600, "1 Year": 1200 },
    "Microsoft 365": { "1 Year": 500, "1 Month": 70 },
    "Canva Pro": { "1 Year": 150 },
    "Duolingo": { "1 Year": 150 },
    "Assignment Check": {
      "Basic AI Detection": 50,
      "AI Bypass": 100,
      "AI Bypass Plus": 300
    },
    "Perplexity": { "1 Year": 200 },
    "Amazon Prime Video": { "1 Year": 999 },
    "Adobe Creative Cloud": { "1 Month": 450 }
  };

  const serviceEl = document.getElementById('service');
  const durationEl = document.getElementById('duration');
  const priceInput = document.getElementById('price');
  const priceDisplay = document.getElementById('priceDisplay').querySelector('span');

  function updatePrice() {
    const service = serviceEl.value;
    const duration = durationEl.value;
    const price = priceMap[service]?.[duration];

    if (price !== undefined) {
      const usd = (price / 15.42).toFixed(2);
      priceInput.value = `MVR ${price}`;
      priceDisplay.textContent = `MVR ${price} ($${usd})`;
    } else {
      priceInput.value = "";
      priceDisplay.textContent = "Unavailable";
    }
  }

  serviceEl.onchange = updatePrice;
  durationEl.onchange = updatePrice;
  window.onload = updatePrice;

  document.getElementById('customerForm').onsubmit = async (e) => {
    e.preventDefault();
    const formData = new FormData(e.target);
    const data = Object.fromEntries(formData.entries());

    try {
      const res = await fetch('https://script.google.com/macros/s/YOUR_DEPLOYED_WEB_APP_ID/exec', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      const result = await res.json();
      alert('âœ… Request submitted successfully!');
      e.target.reset();
    } catch (err) {
      alert('âŒ Something went wrong. Please try again later.');
    }
  };
</script>
